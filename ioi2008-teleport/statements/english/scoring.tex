In test data worth $30$ points, $N \le 500$ and $M \le 500$.
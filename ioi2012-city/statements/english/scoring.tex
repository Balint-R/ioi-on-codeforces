\begin{tabular}{cclc}
\bf{Subtask}&\bf{Points}&\bf{Conditions}\\
1&11&$N \le 200$\\
2&21&$N \le 2\,000$\\
3&23&$N \le 100\,000$&\LARGE{$*$}\\
4&45&$N \le 100\,000$\\
\end{tabular}

\LARGE{$*$} Additionally, the following two conditions hold for the 3-rd subtask: 
\begin{itemize}
\item given any two non-empty cells $i$ and $j$ such that $X[i] = X[j]$, every cell between them is non-empty too;
\item given any two non-empty cells $i$ and $j$ such that $Y[i] = Y[j]$, every cell between them is non-empty too.
\end{itemize} 

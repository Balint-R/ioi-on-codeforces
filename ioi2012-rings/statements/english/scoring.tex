\bf{Subtask 1 [20 points]}

\begin{itemize}
\item $N \le 5\,000$.
\item The function \t{CountCritical} is called only once, after all the other calls; the function \t{Link} is called at most $5\,000$ times.
\end{itemize}

\bf{Subtask 2 [17 points]}

\begin{itemize}
\item $N \le 1\,000\,000$.
\item The function \t{CountCritical} is called only once, after all the other calls; the function \t{Link} is called at most $1\,000\,000$ times.
\end{itemize}

\bf{Subtask 3 [18 points]}

\begin{itemize}
\item $N \le 20\,000$.
\item The function \t{CountCritical} is called at most $100$ times; the function \t{Link} is called at most $10\,000$ times.
\end{itemize}

\bf{Subtask 4 [14 points]}

\begin{itemize}
\item $N \le 100\,000$.
\item The functions \t{CountCritical} and \t{Link} are called, in total, at most $100\,000$ times.
\end{itemize}

\bf{Subtask 5 [31 points]}

\begin{itemize}
\item $N \le 1\,000\,000$.
\item The functions \t{CountCritical} and \t{Link} are called, in total, at most $1\,000\,000$ times.
\end{itemize}

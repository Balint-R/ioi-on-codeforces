Обозначим сумму всех значений M во всех вызовах функцией $can(M, K)$ за $S$.
\begin{center}
\begin{tabular}{|c|c|c|c|c|}
\hline
Подзадача & Баллы & $N$ & $Q$ & Дополнительные ограничения\\
\hline
1 & 21 & $1 \le N \le 100$ & $1 \le Q \le 100$ & Нет \\
\hline
2 & 13 & $1 \le N \le 100\,000$ & $Q = 1$ & Нет \\
\hline
3 & 43 & $1 \le N \le 100\,000$ & $1 \le Q \le 100\,000$ & $S \le 100\,000$ \\
\hline
4 & 23 & $1 \le N \le 500\,000$ & $1 \le Q \le 200\,000$ & $S \le 200\,000$\\
\hline
\end{tabular}
\end{center}